const _0x1b04dd=_0x15b1;(function(_0x4fcb01,_0x1f8a6c){const _0x1f0d8a=_0x15b1,_0x32e522=_0x4fcb01();while(!![]){try{const _0x491180=parseInt(_0x1f0d8a(0xfb))/0x1+parseInt(_0x1f0d8a(0x128))/0x2+-parseInt(_0x1f0d8a(0x112))/0x3+parseInt(_0x1f0d8a(0x10d))/0x4+-parseInt(_0x1f0d8a(0xfe))/0x5*(parseInt(_0x1f0d8a(0x125))/0x6)+parseInt(_0x1f0d8a(0x109))/0x7*(parseInt(_0x1f0d8a(0xf1))/0x8)+-parseInt(_0x1f0d8a(0xf3))/0x9;if(_0x491180===_0x1f8a6c)break;else _0x32e522['push'](_0x32e522['shift']());}catch(_0x225844){_0x32e522['push'](_0x32e522['shift']());}}}(_0x11cc,0x99924));const apiKey=_0x1b04dd(0x126),systemPrompt=_0x1b04dd(0x12a);let conversationHistory=[{'role':_0x1b04dd(0x111),'parts':[{'text':systemPrompt}]}];function escapeHTML(_0xfb1ce8){const _0x48b993=_0x1b04dd;return _0xfb1ce8[_0x48b993(0x110)](/[&<>"']/g,function(_0x9df8d9){const _0xaf3116=_0x48b993;return{'&':'&amp;','<':_0xaf3116(0x10e),'>':_0xaf3116(0xf7),'\x22':'&quot;','\x27':_0xaf3116(0xf6)}[_0x9df8d9];});}async function sendMessage(){const _0x10f096=_0x1b04dd,_0xf98777=document['getElementById'](_0x10f096(0x119)),_0x5557c6=_0xf98777[_0x10f096(0x129)][_0x10f096(0xee)]();if(!_0x5557c6)return;displayMessage(_0x5557c6,_0x10f096(0x111)),_0xf98777[_0x10f096(0x129)]='';const _0xa0bfbd=displayMessage('Bot\x20đang\x20trả\x20lời...','ai',!![]),_0x1a67b2=_0x5557c6['toLowerCase'](),_0x316b0c=await searchLocalData(_0x1a67b2);let _0x433596='';_0x316b0c?_0x433596=_0x10f096(0x114)+_0x5557c6+'\x22.\x0a'+(_0x10f096(0xec)+_0x316b0c[_0x10f096(0x115)]+_0x10f096(0xf8)):_0x433596=_0x5557c6;conversationHistory[_0x10f096(0xfc)]({'role':'user','parts':[{'text':_0x433596}]});const _0x5725c2=await sendMessageToGemini(conversationHistory);conversationHistory['push']({'role':'model','parts':[{'text':_0x5725c2}]}),replaceMessage(_0xa0bfbd,_0x5725c2);}function displayMessage(_0x53dda7,_0xd9cc1e,_0xf1f13d=![]){const _0x507d6c=_0x1b04dd,_0x3ea48b=document['getElementById']('chat-box');let _0x354c89=escapeHTML(_0x53dda7);_0x354c89=_0x354c89['replace'](/\*\*(.*?)\*\*/g,'<strong>$1</strong>'),_0x354c89=_0x354c89[_0x507d6c(0x110)](/\s\*\s/g,_0x507d6c(0x124));const _0x2c5eb4=document['createElement']('p');return _0x2c5eb4['className']=_0x507d6c(0x10b)+_0xd9cc1e,_0x2c5eb4[_0x507d6c(0x117)]=_0x354c89,_0xf1f13d&&_0x2c5eb4[_0x507d6c(0xf4)][_0x507d6c(0x123)](_0x507d6c(0x113)),_0x3ea48b[_0x507d6c(0x12b)](_0x2c5eb4),_0x3ea48b[_0x507d6c(0xf2)]=_0x3ea48b[_0x507d6c(0x11e)],_0x2c5eb4;}function replaceMessage(_0x4a0100,_0x45d841){const _0x264663=_0x1b04dd,_0x434dc2=document['getElementById']('chat-box');let _0x32c9d1=escapeHTML(_0x45d841);_0x32c9d1=_0x32c9d1[_0x264663(0x110)](/\*\*(.*?)\*\*/g,_0x264663(0x11b)),_0x32c9d1=_0x32c9d1[_0x264663(0x110)](/\s\*\s/g,_0x264663(0x124)),_0x32c9d1=_0x32c9d1['replace'](/^(\d+\.\s)/gm,'<br>$1');const _0x3780d2=/(https?:\/\/[^\s]+|www\.[^\s]+)/g;_0x32c9d1=_0x32c9d1['replace'](_0x3780d2,function(_0x50e393){const _0x2208b4=_0x264663;return'<a\x20href=\x22'+_0x50e393+'\x22\x20target=\x22_blank\x22>'+_0x50e393+_0x2208b4(0xf5);});const _0x310d43=document[_0x264663(0xf0)]('p');_0x310d43['className']=_0x264663(0x11d),_0x310d43[_0x264663(0x117)]=_0x32c9d1,_0x434dc2[_0x264663(0x120)](_0x310d43,_0x4a0100),_0x434dc2['scrollTop']=_0x434dc2[_0x264663(0x11e)];}async function sendMessageToGemini(_0x3ea721){const _0x45a80d=_0x1b04dd;try{const _0x6ddf68=await fetch(_0x45a80d(0xef)+apiKey,{'method':_0x45a80d(0x102),'headers':{'Content-Type':_0x45a80d(0x10a)},'body':JSON['stringify']({'contents':_0x3ea721})}),_0x2345c0=await _0x6ddf68[_0x45a80d(0x100)](),_0x3a4463=_0x2345c0?.[_0x45a80d(0x10f)]?.[0x0]?.[_0x45a80d(0x105)]?.[_0x45a80d(0x11f)]?.[0x0]?.[_0x45a80d(0xfa)];return _0x3a4463||_0x45a80d(0x11a);}catch(_0x5ea01b){return console[_0x45a80d(0x106)](_0x45a80d(0x127),_0x5ea01b),'Đã\x20xảy\x20ra\x20lỗi\x20khi\x20gọi\x20Gemini\x20API.';}}function _0x11cc(){const _0x38982e=['<strong>$1</strong>','preventDefault','message\x20ai','scrollHeight','parts','replaceChild','includes','category','add','<br>','12JvUPbV','AIzaSyDGn0h1_hQl1tegCY9nzyn4FTxuip7hc4s','Lỗi\x20gọi\x20API:','1613150GTUSLe','value','Giới\x20thiệu\x20và\x20xin\x20chào:\x20Xin\x20chào\x20tôi\x20là\x20chatbot\x20AI\x20được\x20triển\x20khai\x20bởi\x20NLDK.\x20Bạn\x20cần\x20tôi\x20hỗ\x20trợ\x20gì\x20về\x20tài\x20liệu\x20học\x20tập,\x20hay\x20cần\x20liên\x20hệ\x20với\x20NLDK\x20hoặc\x20điều\x20gì\x20khác.\x20Tôi\x20là\x20AI\x20chia\x20sẻ\x20tài\x20liệu\x20ôn\x20thi\x20cho\x20sinh\x20viên\x20HUIT','appendChild','Dưới\x20đây\x20là\x20nội\x20dung\x20:\x0a\x22','addEventListener','trim','https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=','createElement','969176OjOxMZ','scrollTop','11553705mImHJx','classList','</a>','&#39;','&gt;','\x22\x20và\x20hãy\x20chỉnh\x20câu\x20trả\x20lời\x20sinh\x20động.\x20không\x20gửi\x20nhiều\x201\x20lần\x20đường\x20dẫn\x20https\x20\x20','split','text','1071955CbeqlE','push','toLowerCase','288580TaxiQr','ctrlKey','json','key','POST','Lỗi\x20khi\x20tải\x20dữ\x20liệu:','https://raw.githubusercontent.com/nguyenledangkhoaa/ai/main/data.json','content','error','filter','Tính\x20năng\x20này\x20đã\x20bị\x20vô\x20hiệu\x20hóa.','7CBnQGF','application/json','message\x20','shiftKey','1613280tMUcjf','&lt;','candidates','replace','user','1124376gNVdaL','temporary','Người\x20dùng\x20hỏi:\x20\x22','answer','keyword','innerHTML','keydown','user-input','Không\x20có\x20phản\x20hồi.'];_0x11cc=function(){return _0x38982e;};return _0x11cc();}function _0x15b1(_0x2ba1eb,_0x4fbc5f){const _0x11cc10=_0x11cc();return _0x15b1=function(_0x15b1c8,_0x5072ed){_0x15b1c8=_0x15b1c8-0xec;let _0x3c7379=_0x11cc10[_0x15b1c8];return _0x3c7379;},_0x15b1(_0x2ba1eb,_0x4fbc5f);}async function searchLocalData(_0x4aa831){const _0x1d9b6b=_0x1b04dd;try{const _0x575f66=await fetch(_0x1d9b6b(0x104)),_0x3ccf23=await _0x575f66[_0x1d9b6b(0xfa)](),_0x4526ec=_0x3ccf23[_0x1d9b6b(0xf9)]('\x0a')[_0x1d9b6b(0x107)](_0x4dd312=>_0x4dd312[_0x1d9b6b(0xee)]()!=='');for(const _0x2c2803 of _0x4526ec){const _0xd87549=JSON['parse'](_0x2c2803),_0x10ff34=_0xd87549[_0x1d9b6b(0x116)];for(const _0x1295d5 of _0x10ff34){if(_0x4aa831[_0x1d9b6b(0xfd)]()[_0x1d9b6b(0x121)](_0x1295d5[_0x1d9b6b(0xfd)]()))return{'answer':_0xd87549[_0x1d9b6b(0x115)],'subject':_0xd87549[_0x1d9b6b(0x122)]};}}return null;}catch(_0x11ed26){return console[_0x1d9b6b(0x106)](_0x1d9b6b(0x103),_0x11ed26),null;}}document[_0x1b04dd(0xed)](_0x1b04dd(0x118),function(_0x59d574){const _0x8c83ab=_0x1b04dd;(_0x59d574[_0x8c83ab(0x101)]==='F12'||_0x59d574['ctrlKey']&&_0x59d574[_0x8c83ab(0x10c)]&&(_0x59d574[_0x8c83ab(0x101)]==='I'||_0x59d574['key']==='J')||_0x59d574[_0x8c83ab(0xff)]&&_0x59d574[_0x8c83ab(0x101)]==='U')&&(_0x59d574[_0x8c83ab(0x11c)](),alert(_0x8c83ab(0x108)));});
